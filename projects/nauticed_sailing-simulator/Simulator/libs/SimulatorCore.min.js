"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}window.initSimulator=function(createjs,stage,root){var simulator=new SimulatorCore(createjs,stage,root)};var SimulatorCore=function(){_createClass(SimulatorCore,[{key:"_properties",value:function _properties(createjs,stage,root){this._createjs=createjs;this._stage=stage;this._root=root;this._isTooltipOn=true;this._isTooltipChilBtnDown=false;this._isTooltipOnMobShown=false;this._isNotifierOn=false;this._mcTooltip=this._root.tooltip;this._mcNavigator=this._root.navigator;this._mcNotifierTacking=this._root.navigator.notifierTacking;this._mcNotifier=this._root.navigator.notifier;this._mcNotifierGybing=this._root.navigator.notifierGybing;this._mcWind=this._root.navigator.wind;this._mcSlider=this._root.navigator.wind.slider;this._mcSliderDragger=this._root.navigator.wind.slider.sliderDragger;this._mcSliderBg=this._root.navigator.wind.slider.sliderBg;this._mcNavigatorHit=this._root.navigator.navigatorHit;this._mcSailBoat=this._root.navigator.sailBoat;this._mcRudder=this._root.navigator.sailBoat.sails.rudder;this._mcMainSailMirror=this._root.navigator.sailBoat.sails.mainSailMirror;this._mcMainSail=this._root.navigator.sailBoat.sails.mainSail;this._mcJibSailMirror=this._root.navigator.sailBoat.sails.jibSailMirror;this._mcJibSail=this._root.navigator.sailBoat.sails.jibSail;this._mcHeader=this._root.header;this._mcCheckBox=this._root.checkBox;this._mcCheckBoxIc=this._root.checkBox.checkBoxIc;this._mcMainWinch=this._root.mainWinch;this._mcJibWinch=this._root.jibWinch;this._mcHelm=this._root.helm;this._mcEMeter=this._root.eMeter;this._mcMainWinchBtnL=this._root.mainWinch.buttons.btnL;this._mcMainWinchBtnR=this._root.mainWinch.buttons.btnR;this._mcJibWinchBtnL=this._root.jibWinch.buttons.btnL;this._mcJibWinchBtnR=this._root.jibWinch.buttons.btnR;this._mcHelmBtnL=this._root.helm.buttons.btnL;this._mcHelmBtnR=this._root.helm.buttons.btnR;this._mcMainWinchMask=this._root.mainWinch.halfCircle.theMask;this._mcJibWinchMask=this._root.jibWinch.halfCircle.theMask;this._mcEMeterMask=this._root.eMeter.eMeterHolder.theMask;this._mcTxtSpeedHit=this._root.lcd.txtSpeedHit;this._mcTxtHeelHit=this._root.lcd.txtHeelHit;this._mcTxtWindHit=this._root.lcd.txtWindHit;this._mcTxtHdgHit=this._root.lcd.txtHdgHit;this._mcTxtDepthHit=this._root.lcd.txtDepthHit;this._mcNotifierFix=this._root.notifierFix;this._txtSpeed=this._root.lcd.txtSpeed;this._txtHeel=this._root.lcd.txtHeel;this._txtWind=this._root.lcd.txtWind;this._txtHdg=this._root.lcd.txtHdg;this._txtDepth=this._root.lcd.txtDepth;this._txtMainWinch=this._root.mainWinch.txt;this._txtJibWinch=this._root.jibWinch.txt;this._txtNotifierFix=this._root.notifierFix.txt;this._txtNotifier=this._root.navigator.notifier.txt;this._intervalCurr;this._timeoutBoatToDef;this._calMainWinchPos=SimulatorCore.DEFAULTS.MAIN_WINCH_DEFAULT;this._calJibWinchPos=SimulatorCore.DEFAULTS.JIB_WINCH_DEFAULT;this._calHelmPos=SimulatorCore.DEFAULTS.HELM_DEFAULT;this._calMeterWidthOrig=this._mcEMeterMask.nominalBounds.width;this._calMeterWidthDesire=0;this._cal_v_depth=SimulatorCore.DEFAULTS.DEPTH_DEFAULT;this._cal_v_windSpeed=SimulatorCore.DEFAULTS.WIND_SPEED_DEFAULT;this._cal_v_efficiency=0;this._cal_v_windAngel;this._cal_v_heelAngle;this._cal_v_boatSpeed;this._cal_v_hdg;this._cal_v_angleDescription;this._cal_v_oldAngleDescription;this._objMover_remainingAngel;this._objMover_max;this._objMover_min;this._objMover_name;this._objMover_curr;this._objMover_currTarget}}]);function SimulatorCore(createjs,stage,root){var _this=this;_classCallCheck(this,SimulatorCore);this._properties(createjs,stage,root);this._starterSetDefaults();setTimeout(function(){_this._starterNotifyToPlay();_this._starterAddListenersForBtns()},SimulatorCore.DEFAULTS.INTERVALS*48);this._objMoverValuesUpdate("mainWinch","left");setTimeout(function(){_this._objMoverValuesUpdate("jibWinch","left")},SimulatorCore.DEFAULTS.INTERVALS*24);setInterval(function(){_this._objMover()},SimulatorCore.DEFAULTS.INTERVALS);setInterval(function(){_this._depthControl()},SimulatorCore.DEFAULTS.INTERVAL_DEPTH)}_createClass(SimulatorCore,[{key:"_starterSetDefaults",value:function _starterSetDefaults(){this._mcTooltip.mouseEnabled=false;this._mcTooltip.mouseChildren=false;this._mcTooltip.alpha=0;this._mcNotifierTacking.mouseEnabled=false;this._mcNotifierTacking.mouseChildren=false;this._mcNotifierTacking.alpha=0;this._mcNotifier.mouseEnabled=false;this._mcNotifier.mouseChildren=false;this._mcNotifier.alpha=0;this._mcNotifierGybing.mouseEnabled=false;this._mcNotifierGybing.mouseChildren=false;this._mcNotifierGybing.alpha=0;this._mcMainWinchBtnL.alpha=.5;this._mcMainWinchBtnR.alpha=.5;this._mcJibWinchBtnL.alpha=.5;this._mcJibWinchBtnR.alpha=.5;this._mcHelm.alpha=.5;this._mcSlider.visible=false;this._txtMainWinch.text=this._calMainWinchPos.toString();this._txtJibWinch.text=this._calJibWinchPos.toString();this._mcEMeterMask.scaleX=.003}},{key:"_starterNotifyToPlay",value:function _starterNotifyToPlay(){this._mcMainWinchBtnL.alpha=1;this._mcMainWinchBtnR.alpha=1;this._mcJibWinchBtnL.alpha=1;this._mcJibWinchBtnR.alpha=1;this._mcHelm.alpha=1;this._txtNotifier.text="Start Playing!";this._aniNotifier(this._mcNotifier)}},{key:"_starterAddListenersForBtns",value:function _starterAddListenersForBtns(){this._addListenerForHeader(this._mcHeader);this._addListenersForWind(this._mcWind,this._mcSlider,this._mcSliderDragger,this._mcSliderBg);this._addListenersForCheckbox(this._mcCheckBox,this._mcCheckBoxIc,this._mcTooltip);this._addListenersForPressBtns(this._mcMainWinchBtnL,"mainWinch","left");this._addListenersForPressBtns(this._mcMainWinchBtnR,"mainWinch","right");this._addListenersForPressBtns(this._mcJibWinchBtnL,"jibWinch","left");this._addListenersForPressBtns(this._mcJibWinchBtnR,"jibWinch","right");this._addListenersForPressBtns(this._mcHelmBtnL,"helm","left");this._addListenersForPressBtns(this._mcHelmBtnR,"helm","right");this._addListenersForTooltips(this._mcMainWinch,this._mcTooltip,"mainWinch");this._addListenersForTooltips(this._mcJibWinch,this._mcTooltip,"jibWinch");this._addListenersForTooltips(this._mcHelm,this._mcTooltip,"helm");this._addListenersForTooltips(this._mcEMeter,this._mcTooltip,"eMeter");this._addListenersForTooltips(this._mcWind,this._mcTooltip,"wind");this._addListenersForTooltips(this._mcNavigatorHit,this._mcTooltip,"navigatorHit");this._addListenersForTooltips(this._mcRudder,this._mcTooltip,"rudder");this._addListenersForTooltips(this._mcMainSailMirror,this._mcTooltip,"mainSailMirror");this._addListenersForTooltips(this._mcMainSail,this._mcTooltip,"mainSail");this._addListenersForTooltips(this._mcJibSailMirror,this._mcTooltip,"jibSailMirror");this._addListenersForTooltips(this._mcJibSail,this._mcTooltip,"jibSail");this._addListenersForTooltips(this._mcTxtSpeedHit,this._mcTooltip,"txtSpeedHit");this._addListenersForTooltips(this._mcTxtHeelHit,this._mcTooltip,"txtHeelHit");this._addListenersForTooltips(this._mcTxtWindHit,this._mcTooltip,"txtWindHit");this._addListenersForTooltips(this._mcTxtHdgHit,this._mcTooltip,"txtHdgHit");this._addListenersForTooltips(this._mcTxtDepthHit,this._mcTooltip,"txtDepthHit");this._addListenersForTooltips(this._mcNotifierFix,this._mcTooltip,"notifierFix")}},{key:"_addListenerForHeader",value:function _addListenerForHeader(el){el.cursor="pointer";el.addEventListener("click",function(){window.open("https://www.nauticed.org/","_blank")})}},{key:"_addListenersForWind",value:function _addListenersForWind(el,slider,sliderDragger,sliderBg){var _isSliderVisible=false;el.addEventListener("mouseover",function(){el.gotoAndStop("over")});el.addEventListener("mouseout",function(){el.gotoAndStop("out")});el.addEventListener("click",function(e){if(e.target==slider.instance||e.target==sliderDragger.instance||e.target==sliderBg.instance)return;if(!_isSliderVisible){_isSliderVisible=true;slider.visible=true}else{_isSliderVisible=false;slider.visible=false}});this._stage.addEventListener("click",function(e){if(e.target==el.instance||e.target==el.instance_1||e.target==slider.instance||e.target==sliderDragger.instance||e.target==sliderBg.instance)return;if(_isSliderVisible){_isSliderVisible=false;slider.visible=false}});this._slider(sliderDragger,sliderBg,this._getWindPerc(this._cal_v_windSpeed),this._sliderIsMoving)}},{key:"_addListenersForCheckbox",value:function _addListenersForCheckbox(el,ic,tooltip){var _this2=this;el.mouseChildren=false;var _isCheckBoxIcVisible=true;el.addEventListener("mouseover",function(){el.gotoAndStop("over")});el.addEventListener("mouseout",function(){el.gotoAndStop("out")});el.addEventListener("click",function(){if(_isCheckBoxIcVisible){_isCheckBoxIcVisible=false;_this2._isTooltipOn=false;ic.visible=false;_this2._aniTooltip(tooltip,false);_this2._isTooltipOnMobShown=false}else{_isCheckBoxIcVisible=true;_this2._isTooltipOn=true;ic.visible=true}})}},{key:"_addListenersForPressBtns",value:function _addListenersForPressBtns(el,elName,elDirection){var _this3=this;el.mouseChildren=false;var _isOver=false;var _isDown=false;el.addEventListener("mouseover",function(){_isOver=true;if(!_isDown)el.gotoAndStop("over")});el.addEventListener("mouseout",function(){_isOver=false;if(!_isDown)el.gotoAndStop("out")});el.addEventListener("mousedown",function(){_this3._isTooltipChilBtnDown=true;_isDown=true;el.gotoAndStop("down");_this3._intervalSet(elName,elDirection);if(elName=="helm")_this3._helmIsDown(elDirection)});el.addEventListener("pressup",function(){_this3._isTooltipChilBtnDown=false;_isDown=false;if(_isOver)el.gotoAndStop("over");else el.gotoAndStop("out");_this3._intervalRemove();if(elName=="helm")_this3._helmIsUp(elDirection)})}},{key:"_addListenersForTooltips",value:function _addListenersForTooltips(el,tooltip,tooltipStopFrame){var _this4=this;var _isOver=false;el.addEventListener("rollover",function(){if(!_this4._isTooltipOn)return;_isOver=true;tooltip.gotoAndStop(tooltipStopFrame);_this4._aniTooltip(tooltip,true)});el.addEventListener("click",function(){if(!_this4._isTooltipOn)return;if(_isOver)return;if(!_this4._isTooltipOnMobShown&&_this4._isTooltipChilBtnDown||!_this4._isTooltipOnMobShown&&!_this4._isTooltipChilBtnDown){_this4._isTooltipOnMobShown=true;tooltip.gotoAndStop(tooltipStopFrame);_this4._aniTooltip(tooltip,true)}else if(_this4._isTooltipOnMobShown&&_this4._isTooltipChilBtnDown){tooltip.gotoAndStop(tooltipStopFrame)}else if(_this4._isTooltipOnMobShown&&!_this4._isTooltipChilBtnDown){_this4._isTooltipOnMobShown=false;_this4._aniTooltip(tooltip,false,200,function(){return tooltip.gotoAndStop(tooltipStopFrame)})}});el.addEventListener("rollout",function(){if(!_this4._isTooltipOn)return;_isOver=false;_this4._aniTooltip(tooltip,false)})}},{key:"_slider",value:function _slider(dragger,bg,initPerc,onMoveFun){var _this5=this;var onUpFun=arguments.length>4&&arguments[4]!==undefined?arguments[4]:function(p){};var direction=arguments.length>5&&arguments[5]!==undefined?arguments[5]:"vertical";var _finPerc=initPerc;var _localCoords;if(direction=="vertical"){dragger.y=this._sliderGetPos(initPerc,dragger.nominalBounds.height,bg.nominalBounds.height)}else if(direction=="horizontal"){dragger.x=this._sliderGetPos(initPerc,dragger.nominalBounds.width,bg.nominalBounds.width)}dragger.addEventListener("mousedown",function(e){_localCoords=bg.globalToLocal(e.stageX,e.stageY);if(direction=="vertical")dragger.offsetY=_localCoords.y-dragger.y;else if(direction=="horizontal")dragger.offsetX=_localCoords.x-dragger.x});dragger.addEventListener("pressmove",function(e){_localCoords=bg.globalToLocal(e.stageX,e.stageY);if(direction=="vertical"){dragger.y=_this5._sliderGetClamp(_localCoords.y-dragger.offsetY,bg.y,bg.y+bg.nominalBounds.height-dragger.nominalBounds.height);_finPerc=_this5._sliderGetPerc(dragger.y,dragger.nominalBounds.height,bg.nominalBounds.height)}else if(direction=="horizontal"){dragger.x=_this5._sliderGetClamp(_localCoords.x-dragger.offsetX,bg.x,bg.x+bg.nominalBounds.width-dragger.nominalBounds.width);_finPerc=_this5._sliderGetPerc(dragger.x,dragger.nominalBounds.width,bg.nominalBounds.width)}onMoveFun.bind(_this5,_finPerc).call()});dragger.addEventListener("pressup",function(){onUpFun.bind(_this5,_finPerc).call()})}},{key:"_sliderGetClamp",value:function _sliderGetClamp(value,min,max){if(value<min)return min;else if(value>max)return max;else return value}},{key:"_sliderGetPerc",value:function _sliderGetPerc(draggerPos,draggerSize,bgSize){var _availableSize=bgSize-draggerSize;var _perc=Math.round(100*draggerPos/_availableSize);return _perc}},{key:"_sliderGetPos",value:function _sliderGetPos(draggerPerc,draggerSize,bgSize){var _availableSize=bgSize-draggerSize;var _pos=draggerPerc*_availableSize/100;return _pos}},{key:"_sliderIsMoving",value:function _sliderIsMoving(perc){this._cal_v_windSpeed=this._getWindVal(perc)}},{key:"_getWindPerc",value:function _getWindPerc(val){var _min=SimulatorCore.DEFAULTS.WIND_SPEED_MIN;var _max=SimulatorCore.DEFAULTS.WIND_SPEED_MAX;return Math.round(100*(val-_min)/(_max-_min))}},{key:"_getWindVal",value:function _getWindVal(perc){var _min=SimulatorCore.DEFAULTS.WIND_SPEED_MIN;var _max=SimulatorCore.DEFAULTS.WIND_SPEED_MAX;return Math.round(perc/100*(_max-_min)+_min)}},{key:"_aniTooltip",value:function _aniTooltip(tooltip,makeVisible){var duration=arguments.length>2&&arguments[2]!==undefined?arguments[2]:200;var onCompleteFun=arguments.length>3&&arguments[3]!==undefined?arguments[3]:function(){};if(makeVisible)this._createjs.Tween.get(tooltip).to({alpha:1},duration).call(onCompleteFun);else this._createjs.Tween.get(tooltip).to({alpha:0},duration).call(onCompleteFun)}},{key:"_aniNotifier",value:function _aniNotifier(notifier){var _this6=this;var duration=arguments.length>1&&arguments[1]!==undefined?arguments[1]:200;var fadeOutTimeout=arguments.length>2&&arguments[2]!==undefined?arguments[2]:SimulatorCore.DEFAULTS.TIMEOUT_NOTIFIER_FADE_OUT;this._createjs.Tween.get(notifier).to({alpha:1},duration);setTimeout(function(){_this6._createjs.Tween.get(notifier).to({alpha:0},duration)},fadeOutTimeout)}},{key:"_aniRotate",value:function _aniRotate(el,value){var duration=arguments.length>2&&arguments[2]!==undefined?arguments[2]:200;var onCompleteFun=arguments.length>3&&arguments[3]!==undefined?arguments[3]:function(){};this._createjs.Tween.get(el).to({rotation:value},duration,this._createjs.Ease.getPowInOut(2.2)).call(onCompleteFun)}},{key:"_aniBoatBlink",value:function _aniBoatBlink(boat){var duration=arguments.length>1&&arguments[1]!==undefined?arguments[1]:200;boat.alpha=0;this._createjs.Tween.get(boat).to({alpha:1},duration)}},{key:"_helmIsDown",value:function _helmIsDown(elDirection){if(elDirection=="right")this._aniRotate(this._mcRudder,SimulatorCore.DEFAULTS.RUDDER_MIN);else this._aniRotate(this._mcRudder,SimulatorCore.DEFAULTS.RUDDER_MAX);this._timeoutRemoveBoatToDef()}},{key:"_helmIsUp",value:function _helmIsUp(elDirection){this._aniRotate(this._mcRudder,SimulatorCore.DEFAULTS.RUDDER_DEFAULT);this._timeoutSetBoatToDef(elDirection)}},{key:"_timeoutSetBoatToDef",value:function _timeoutSetBoatToDef(elDirection){var _this7=this;this._timeoutBoatToDef=setTimeout(function(){_this7._aniBoatBlink(_this7._mcSailBoat,600);_this7._calHelmPos=SimulatorCore.DEFAULTS.HELM_DEFAULT;_this7._aniRotate(_this7._mcSailBoat,_this7._calHelmPos,600);_this7._aniRotate(_this7._mcWind,_this7._calHelmPos+_this7._cal_v_windAngel,600,function(){if(_this7._mcWind.rotation<=-180)_this7._mcWind.rotation=360-Math.abs(_this7._mcWind.rotation);else if(_this7._mcWind.rotation>=180)_this7._mcWind.rotation=_this7._mcWind.rotation-360});_this7._objMoverValuesUpdate("mainWinch",elDirection)},SimulatorCore.DEFAULTS.TIMEOUT_BOAT_BACK_TO_DEF)}},{key:"_timeoutRemoveBoatToDef",value:function _timeoutRemoveBoatToDef(interval){clearTimeout(this._timeoutBoatToDef)}},{key:"_intervalSet",value:function _intervalSet(elName,elDirection){var _this8=this;var ms=arguments.length>2&&arguments[2]!==undefined?arguments[2]:SimulatorCore.DEFAULTS.INTERVALS;this._intervalCurr=setInterval(function(){switch(elName){case"mainWinch":_this8._aniMainWinch(elDirection);break;case"jibWinch":_this8._aniJibWinch(elDirection);break;case"helm":_this8._aniHelm(elDirection);break}},ms)}},{key:"_intervalRemove",value:function _intervalRemove(interval){clearInterval(this._intervalCurr)}},{key:"_aniMainWinch",value:function _aniMainWinch(elDirection){var _elName="mainWinch";if(elDirection=="right"){this._calMainWinchPos++;if(this._calMainWinchPos<=SimulatorCore.DEFAULTS.MAIN_WINCH_MAX){this._txtMainWinch.text=this._calMainWinchPos.toString();this._objMoverValuesUpdate(_elName,elDirection)}else{this._calMainWinchPos=SimulatorCore.DEFAULTS.MAIN_WINCH_MAX;this._intervalRemove()}}else{this._calMainWinchPos--;if(this._calMainWinchPos>=SimulatorCore.DEFAULTS.MAIN_WINCH_MIN){this._txtMainWinch.text=this._calMainWinchPos.toString();this._objMoverValuesUpdate(_elName,elDirection)}else{this._calMainWinchPos=SimulatorCore.DEFAULTS.MAIN_WINCH_MIN;this._intervalRemove()}}}},{key:"_aniJibWinch",value:function _aniJibWinch(elDirection){var _elName="jibWinch";if(elDirection=="right"){this._calJibWinchPos++;if(this._calJibWinchPos<=SimulatorCore.DEFAULTS.JIB_WINCH_MAX){this._txtJibWinch.text=this._calJibWinchPos.toString();this._objMoverValuesUpdate(_elName,elDirection)}else{this._calJibWinchPos=SimulatorCore.DEFAULTS.JIB_WINCH_MAX;this._intervalRemove()}}else{this._calJibWinchPos--;if(this._calJibWinchPos>=SimulatorCore.DEFAULTS.JIB_WINCH_MIN){this._txtJibWinch.text=this._calJibWinchPos.toString();this._objMoverValuesUpdate(_elName,elDirection)}else{this._calJibWinchPos=SimulatorCore.DEFAULTS.JIB_WINCH_MIN;this._intervalRemove()}}}},{key:"_aniHelm",value:function _aniHelm(elDirection){var _elName="helm";if(elDirection=="right"){this._calHelmPos++;if(this._calHelmPos<=180){this._objMoverValuesUpdate(_elName,elDirection)}else{this._calHelmPos=180;this._intervalRemove()}}else{this._calHelmPos--;if(this._calHelmPos>=-179){this._objMoverValuesUpdate(_elName,elDirection)}else{this._calHelmPos=-179;this._intervalRemove()}}}},{key:"_objMover",value:function _objMover(){var _newRealR;var _newR;var _percent;if(this._objMover_name=="mainWinch"||this._objMover_name=="jibWinch"){_percent=this._findPerc(this._objMover_max-this._objMover_min,this._objMover_curr-this._objMover_min);_newR=this._objMover_remainingAngel/100*_percent;this._objMover_currTarget.rotation=this._objMover_currTarget.rotation-(_newR+this._objMover_currTarget.rotation)/5;if(this._objMover_name=="mainWinch"){_newRealR=(SimulatorCore.DEFAULTS.MAIN_WINCH_REAL_MAX-SimulatorCore.DEFAULTS.MAIN_WINCH_REAL_MIN)/100*_percent;this._mcMainSail.rotation=this._mcMainSail.rotation-(_newRealR+this._mcMainSail.rotation)/5;this._mcMainSailMirror.rotation=-this._mcMainSail.rotation}else if(this._objMover_name=="jibWinch"){_newRealR=(SimulatorCore.DEFAULTS.JIB_WINCH_REAL_MAX-SimulatorCore.DEFAULTS.JIB_WINCH_REAL_MIN)/100*_percent;this._mcJibSail.rotation=this._mcJibSail.rotation-(_newRealR+this._mcJibSail.rotation)/5;this._mcJibSailMirror.rotation=-this._mcJibSail.rotation}}else{_percent=this._findPerc(this._objMover_max-this._objMover_min,this._objMover_curr-this._objMover_min);_newR=-(this._objMover_max-this._objMover_min)/100*_percent;this._objMover_currTarget.rotation=this._objMover_currTarget.rotation-(_newR+this._objMover_currTarget.rotation)/5}var _newE=this._calMeterWidthOrig/100*(this._cal_v_efficiency*100);this._calMeterWidthDesire=this._calMeterWidthDesire+(_newE-this._calMeterWidthDesire)/5;this._mcEMeterMask.scaleX=this._calMeterWidthDesire/this._calMeterWidthOrig;if(this._mcWind.rotation>180||this._mcWind.rotation<-180)return;this._cal_v_windAngel=Math.round(this._mcWind.rotation-this._mcSailBoat.rotation);var _windAngleIndex=this._findWindAngleIndex(this._cal_v_windAngel);var _windSpeedIndex=SimulatorCore.DEFAULTS.WIND_SPEED_ARRAY.indexOf(this._cal_v_windSpeed);var _optBoatSpeed=SimulatorCore.DEFAULTS.OPT_BOAT_SPEED_V[_windAngleIndex][_windSpeedIndex];var _optMain=SimulatorCore.DEFAULTS.OPT_MAIN[_windAngleIndex];var _optJib=SimulatorCore.DEFAULTS.OPT_JIB[_windAngleIndex];var _heelMultiplier=SimulatorCore.DEFAULTS.HEEL_ANGLE[_windAngleIndex];this._cal_v_heelAngle=Math.round(_heelMultiplier*this._cal_v_windSpeed/25);var _mainSpeedMultiplier=this._findMulti(this._calMainWinchPos,_optMain);var _jibSpeedMultiplier=this._findMulti(this._calJibWinchPos,_optJib);this._cal_v_efficiency=_mainSpeedMultiplier*_jibSpeedMultiplier;this._cal_v_boatSpeed=_optBoatSpeed*this._cal_v_efficiency;this._cal_v_hdg=this._findHeading(SimulatorCore.DEFAULTS.WIND_DEFAULT,this._cal_v_windAngel);this._cal_v_angleDescription=this._findAngleDescription(this._cal_v_windAngel);this._updateLcd();if(this._cal_v_windAngel<SimulatorCore.DEFAULTS.SHAKE_MAX&&this._cal_v_windAngel>SimulatorCore.DEFAULTS.SHAKE_MIN){var _shakePercent=Math.pow(this._cal_v_windAngel/SimulatorCore.DEFAULTS.SHAKE_MAX,2)-1;this._mcSailBoat.rotation=this._randNum(this._calHelmPos-_shakePercent,this._calHelmPos+_shakePercent)}if(this._cal_v_windAngel>=0&&this._cal_v_windAngel<=180){this._mcJibSail.visible=true;this._mcJibSailMirror.visible=false}else if(this._cal_v_windAngel<0&&this._cal_v_windAngel>=-180){this._mcJibSail.visible=false;this._mcJibSailMirror.visible=true}else if(this._cal_v_windAngel>180&&this._cal_v_windAngel<360){this._mcJibSail.visible=false;this._mcJibSailMirror.visible=true}else if(this._cal_v_windAngel<-180&&this._cal_v_windAngel>-360){this._mcJibSail.visible=true;this._mcJibSailMirror.visible=false}if(this._cal_v_windAngel>=5&&this._cal_v_windAngel<=165){this._mcMainSail.visible=true;this._mcMainSailMirror.visible=false}else if(this._cal_v_windAngel<-195&&this._cal_v_windAngel>-355){this._mcMainSail.visible=true;this._mcMainSailMirror.visible=false}else if(this._cal_v_windAngel>190&&this._cal_v_windAngel<355){this._mcMainSail.visible=false;this._mcMainSailMirror.visible=true}else if(this._cal_v_windAngel<-5&&this._cal_v_windAngel>-170){this._mcMainSail.visible=false;this._mcMainSailMirror.visible=true}if(this._cal_v_windAngel<10&&this._cal_v_windAngel>-10)this._notifier("tacking");else if(this._cal_v_windAngel>175&&this._cal_v_windAngel<185)this._notifier("gybing");else if(this._cal_v_windAngel<-175&&this._cal_v_windAngel>-185)this._notifier("gybing");else this._isNotifierOn=false;if(this._cal_v_angleDescription!=this._cal_v_oldAngleDescription){this._cal_v_oldAngleDescription=this._cal_v_angleDescription;if(this._isTooltipOn)this._notifier("closeHaul",this._cal_v_angleDescription)}}},{key:"_objMoverValuesUpdate",value:function _objMoverValuesUpdate(elName,elDirection){switch(elName){case"mainWinch":this._objMover_remainingAngel=-180;this._objMover_max=SimulatorCore.DEFAULTS.MAIN_WINCH_MAX;this._objMover_min=SimulatorCore.DEFAULTS.MAIN_WINCH_MIN;this._objMover_name=elName;this._objMover_curr=this._calMainWinchPos;this._objMover_currTarget=this._mcMainWinchMask;break;case"jibWinch":this._objMover_remainingAngel=-180;this._objMover_max=SimulatorCore.DEFAULTS.JIB_WINCH_MAX;this._objMover_min=SimulatorCore.DEFAULTS.JIB_WINCH_MIN;this._objMover_name=elName;this._objMover_curr=this._calJibWinchPos;this._objMover_currTarget=this._mcJibWinchMask;break;case"helm":this._objMover_max=180;this._objMover_min=0;this._objMover_name=elName;this._objMover_curr=this._calHelmPos;this._objMover_currTarget=this._mcSailBoat;break}}},{key:"_depthControl",value:function _depthControl(){this._cal_v_depth=this._cal_v_depth+Math.round(this._randNum(-5,5));if(this._cal_v_depth<SimulatorCore.DEFAULTS.DEPTH_MIN){this._cal_v_depth+=100}else if(this._cal_v_depth>SimulatorCore.DEFAULTS.DEPTH_MAX){this._cal_v_depth-=100}}},{key:"_randNum",value:function _randNum(low,high){return Math.random()*(high-low)+low}},{key:"_findPerc",value:function _findPerc(t,c){var percent=Math.floor(c/t*100);return percent}},{key:"_findWindAngleIndex",value:function _findWindAngleIndex(a){var index=-1;var roundedWindAngle=Math.round(a/5);roundedWindAngle=roundedWindAngle*5;if(roundedWindAngle<0){roundedWindAngle=roundedWindAngle*-1}if(roundedWindAngle<20){roundedWindAngle=0}if(roundedWindAngle>180){roundedWindAngle=360-roundedWindAngle}index=SimulatorCore.DEFAULTS.WIND_ANGLE_ARRAY.indexOf(roundedWindAngle);return index}},{key:"_findMulti",value:function _findMulti(a,b){var multi=0;if(a>=b)multi=Math.pow(1-(a-b)/a,.8);else multi=Math.pow(1-(b-a)/b,.8);return multi}},{key:"_findHeading",value:function _findHeading(a,b){var answer=0;if(a<0)a=a*-1;if(a>=b&&a<360)answer=a-b;else if(a>=0&&a<b)answer=a+(360-b);return answer}},{key:"_findAngleDescription",value:function _findAngleDescription(a){var answer="Wait...";if(a<0)a=a*-1;if(a>=180)a=360-a;if(a>=0&&a<20)answer="No Sail Zone";if(a>=20&&a<30)answer="Pinching";if(a>=30&&a<40)answer="Close Haul";if(a>=40&&a<70)answer="Close Reach";if(a>=70&&a<110)answer="Reach";if(a>=110&&a<150)answer="Broad Reach";if(a>=150&&a<=180)answer="Running";return answer}},{key:"_updateLcd",value:function _updateLcd(){this._txtWind.text=this._cal_v_windSpeed.toString();this._txtHeel.text=this._cal_v_heelAngle.toString();var _speedTxtString=this._cal_v_boatSpeed.toString();this._txtSpeed.text=_speedTxtString.substr(0,4);this._txtHdg.text=this._cal_v_hdg.toString();this._txtDepth.text=this._cal_v_depth.toString();this._txtNotifierFix.text=this._cal_v_angleDescription}},{key:"_notifier",value:function _notifier(a){var txt=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";switch(a){case"tacking":if(this._isNotifierOn)return;this._aniNotifier(this._mcNotifierTacking);this._isNotifierOn=true;break;case"gybing":if(this._isNotifierOn)return;this._aniNotifier(this._mcNotifierGybing);this._isNotifierOn=true;break;case"closeHaul":this._txtNotifier.text=txt;this._aniNotifier(this._mcNotifier);break}}}],[{key:"DEFAULTS",get:function get(){return{INTERVALS:50,INTERVAL_DEPTH:3e3,TIMEOUT_NOTIFIER_FADE_OUT:3400,TIMEOUT_BOAT_BACK_TO_DEF:1e3,MAIN_WINCH_DEFAULT:29,MAIN_WINCH_MIN:5,MAIN_WINCH_MAX:35,MAIN_WINCH_REAL_MIN:0,MAIN_WINCH_REAL_MAX:70,JIB_WINCH_DEFAULT:36,JIB_WINCH_MIN:12,JIB_WINCH_MAX:45,JIB_WINCH_REAL_MIN:0,JIB_WINCH_REAL_MAX:70,HELM_DEFAULT:0,DEPTH_DEFAULT:100,DEPTH_MIN:20,DEPTH_MAX:200,RUDDER_DEFAULT:0,RUDDER_MIN:-30,RUDDER_MAX:30,WIND_DEFAULT:60,WIND_SPEED_MIN:4,WIND_SPEED_MAX:30,WIND_SPEED_DEFAULT:10,SHAKE_MIN:-20,SHAKE_MAX:20,WIND_ANGLE_ARRAY:[0,20,25,30,35,40,45,50,55,60,65,70,75,80,85,90,95,100,105,110,115,120,125,130,135,140,145,150,155,160,165,170,175,180],WIND_SPEED_ARRAY:[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30],OPT_BOAT_SPEED_V:[SimulatorCore.OPT_BOAT_SPEED_0,SimulatorCore.OPT_BOAT_SPEED_1,SimulatorCore.OPT_BOAT_SPEED_2,SimulatorCore.OPT_BOAT_SPEED_3,SimulatorCore.OPT_BOAT_SPEED_4,SimulatorCore.OPT_BOAT_SPEED_5,SimulatorCore.OPT_BOAT_SPEED_6,SimulatorCore.OPT_BOAT_SPEED_7,SimulatorCore.OPT_BOAT_SPEED_8,SimulatorCore.OPT_BOAT_SPEED_9,SimulatorCore.OPT_BOAT_SPEED_10,SimulatorCore.OPT_BOAT_SPEED_11,SimulatorCore.OPT_BOAT_SPEED_12,SimulatorCore.OPT_BOAT_SPEED_13,SimulatorCore.OPT_BOAT_SPEED_14,SimulatorCore.OPT_BOAT_SPEED_15,SimulatorCore.OPT_BOAT_SPEED_16,SimulatorCore.OPT_BOAT_SPEED_17,SimulatorCore.OPT_BOAT_SPEED_18,SimulatorCore.OPT_BOAT_SPEED_19,SimulatorCore.OPT_BOAT_SPEED_20,SimulatorCore.OPT_BOAT_SPEED_21,SimulatorCore.OPT_BOAT_SPEED_22,SimulatorCore.OPT_BOAT_SPEED_23,SimulatorCore.OPT_BOAT_SPEED_24,SimulatorCore.OPT_BOAT_SPEED_25,SimulatorCore.OPT_BOAT_SPEED_26,SimulatorCore.OPT_BOAT_SPEED_27,SimulatorCore.OPT_BOAT_SPEED_28,SimulatorCore.OPT_BOAT_SPEED_29,SimulatorCore.OPT_BOAT_SPEED_30,SimulatorCore.OPT_BOAT_SPEED_31,SimulatorCore.OPT_BOAT_SPEED_32,SimulatorCore.OPT_BOAT_SPEED_33],OPT_MAIN:[0,35,35,35,34,33,32,31,30,29,27,25,23,21,19,17,15,13,12,11,10,9,8,7,6,5,5,5,5,5,5,5,5,5],OPT_JIB:[0,42,42,42,41,40,39,38,37,36,34,32,30,28,26,24,22,20,18,18,17,16,15,14,13,12,12,12,12,12,12,12,12,12],HEEL_ANGLE:[3,20,30,45,43,41,39,37,35,33,31,29,27,25,23,21,19,17,15,13,11,9,7,5,3,1,0,0,0,0,0,0,0,0]}}},{key:"VERSION",get:function get(){return"1.0.0"}},{key:"OPT_BOAT_SPEED_0",get:function get(){return[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},{key:"OPT_BOAT_SPEED_1",get:function get(){return[.3,.3,.3,.3,.3,.3,.9,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{key:"OPT_BOAT_SPEED_2",get:function get(){return[1.3,1.5,1.7,2,2.3,2.5,2.7,2.8,2.9,2.9,3,3,3.1,3.1,3.1,3.1,3.1,3.1,3.1,3.1,3.1,3.1,3.1,3.1,3.2,3.2,3.2]}},{key:"OPT_BOAT_SPEED_3",get:function get(){return[2.1,2.7,3.2,3.8,4.4,4.7,5,5.1,5.2,5.4,5.5,5.6,5.7,5.7,5.8,5.8,5.8,5.8,5.8,5.9,5.9,5.9,5.9,5.9,6,6,6]}},{key:"OPT_BOAT_SPEED_4",get:function get(){return[2.7,3.3,3.9,4.5,5.1,5.4,5.8,5.9,6.1,6.2,6.3,6.3,6.4,6.4,6.5,6.5,6.5,6.5,6.5,6.6,6.6,6.6,6.6,6.6,6.6,6.6,6.7]}},{key:"OPT_BOAT_SPEED_5",get:function get(){return[3.2,3.9,4.6,5.2,5.8,6.2,6.5,6.8,7,7,7,7.1,7.1,7.1,7.2,7.2,7.2,7.2,7.2,7.3,7.3,7.3,7.3,7.3,7.3,7.3,7.3]}},{key:"OPT_BOAT_SPEED_6",get:function get(){return[3.6,4.3,5,5.6,6.3,6.5,6.8,7,7.3,7.3,7.4,7.4,7.5,7.5,7.5,7.5,7.6,7.6,7.6,7.6,7.6,7.7,7.7,7.7,7.7,7.7,7.7]}},{key:"OPT_BOAT_SPEED_7",get:function get(){return[3.9,4.7,5.4,6.1,6.7,6.9,7.1,7.3,7.5,7.6,7.7,7.8,7.8,7.8,7.9,7.9,7.9,7.9,7.9,8,8,8,8,8,8.1,8.1,8.1]}},{key:"OPT_BOAT_SPEED_8",get:function get(){return[4.1,4.9,5.7,6.3,6.9,7.1,7.3,7.5,7.8,7.9,8,8,8.1,8.1,8.2,8.2,8.2,8.2,8.2,8.3,8.3,8.3,8.3,8.3,8.3,8.3,8.4]}},{key:"OPT_BOAT_SPEED_9",get:function get(){return[4.3,5.2,6,6.5,7,7.3,7.5,7.8,8,8.1,8.2,8.3,8.4,8.4,8.5,8.5,8.5,8.5,8.5,8.6,8.6,8.6,8.6,8.6,8.6,8.6,8.6]}},{key:"OPT_BOAT_SPEED_10",get:function get(){return[4.4,5.3,6.2,6.6,7.1,7.3,7.6,7.9,8.1,8.2,8.4,8.4,8.5,8.5,8.6,8.6,8.7,8.7,8.7,8.7,8.8,8.8,8.8,8.8,8.8,8.8,8.9]}},{key:"OPT_BOAT_SPEED_11",get:function get(){return[4.5,5.4,6.3,6.7,7.1,7.4,7.8,8,8.2,8.4,8.5,8.6,8.6,8.7,8.7,8.8,8.8,8.8,8.9,8.9,9,9,9,9,9.1,9.1,9.1]}},{key:"OPT_BOAT_SPEED_12",get:function get(){return[4.6,5.5,6.4,6.8,7.2,7.5,7.8,8.1,8.4,8.5,8.6,8.7,8.8,8.8,8.9,8.9,9,9,9.1,9.1,9.2,9.2,9.2,9.2,9.3,9.3,9.3]}},{key:"OPT_BOAT_SPEED_13",get:function get(){return[4.6,5.6,6.5,6.9,7.2,7.5,7.9,8.2,8.5,8.6,8.6,8.8,8.9,9,9.1,9.1,9.2,9.2,9.3,9.3,9.4,9.4,9.4,9.4,9.5,9.5,9.5]}},{key:"OPT_BOAT_SPEED_14",get:function get(){return[4.6,5.5,6.4,6.8,7.2,7.5,7.8,8.2,8.5,8.6,8.6,8.8,9,9.1,9.2,9.3,9.4,9.5,9.5,9.6,9.6,9.7,9.7,9.8,9.8,9.8,9.9]}},{key:"OPT_BOAT_SPEED_15",get:function get(){return[4.5,5.4,6.3,6.8,7.2,7.5,7.8,8.2,8.5,8.6,8.6,8.8,9,9.2,9.3,9.5,9.6,9.7,9.8,9.8,9.9,10,10,10.1,10.1,10.2,10.2]}},{key:"OPT_BOAT_SPEED_16",get:function get(){return[4.5,5.3,6.2,6.7,7.1,7.4,7.8,8.1,8.4,8.5,8.6,8.8,9,9.1,9.3,9.5,9.7,9.8,9.9,10,10.1,10.3,10.3,10.4,10.5,10.5,10.6]}},{key:"OPT_BOAT_SPEED_17",get:function get(){return[4.4,5.3,6.1,6.6,7,7.4,7.7,8,8.3,8.4,8.5,8.7,8.9,9.1,9.3,9.5,9.7,9.9,10,10.2,10.3,10.5,10.6,10.7,10.8,10.9,11]}},{key:"OPT_BOAT_SPEED_18",get:function get(){return[4.3,5.1,5.9,6.4,6.9,7.3,7.6,7.9,8.2,8.3,8.5,8.7,8.9,9.1,9.3,9.4,9.6,9.8,10,10.2,10.4,10.7,10.8,10.9,11.1,11.2,11.4]}},{key:"OPT_BOAT_SPEED_19",get:function get(){return[4.1,4.9,5.8,6.3,6.8,7.2,7.5,7.8,8.1,8.2,8.4,8.7,8.9,9.1,9.2,9.4,9.5,9.8,10,10.3,10.5,10.8,11,11.2,11.3,11.5,11.7]}},{key:"OPT_BOAT_SPEED_20",get:function get(){return[3.9,4.7,5.4,6,6.7,7,7.4,7.6,7.8,8.1,8.3,8.5,8.7,8.9,9,9.2,9.4,9.6,9.9,10.1,10.4,10.7,10.9,11.1,11.4,11.6,11.9]}},{key:"OPT_BOAT_SPEED_21",get:function get(){return[3.8,4.4,5.1,5.8,6.5,6.9,7.2,7.4,7.6,7.9,8.2,8.4,8.5,8.7,8.9,9,9.2,9.5,9.7,10,10.2,10.5,10.8,11.1,11.4,11.7,12]}},{key:"OPT_BOAT_SPEED_22",get:function get(){return[3.4,4.1,4.8,5.5,6.2,6.6,7.1,7.2,7.3,7.7,8.1,8.2,8.4,8.6,8.8,8.9,9.1,9.3,9.6,9.8,10,10.3,10.6,10.9,11.2,11.5,11.8]}},{key:"OPT_BOAT_SPEED_23",get:function get(){return[3,3.8,4.5,5.2,5.8,6.4,6.9,6.9,7.1,7.4,7.9,8.1,8.3,8.5,8.7,8.8,9,9.2,9.4,9.6,9.8,10.1,10.3,10.6,10.9,11.2,11.5]}},{key:"OPT_BOAT_SPEED_24",get:function get(){return[2.9,3.6,4.4,5,5.6,6.1,6.5,6.7,7.1,7.4,7.7,7.9,8.1,8.3,8.4,8.6,8.8,9,9.2,9.4,9.6,9.8,10.1,10.3,10.6,10.9,11.3]}},{key:"OPT_BOAT_SPEED_25",get:function get(){return[2.8,3.5,4.2,4.8,5.4,5.9,6,6.5,7,7.3,7.5,7.7,7.8,8,8.2,8.4,8.6,8.7,8.9,9.1,9.3,9.5,9.8,10.1,10.3,10.6,11]}},{key:"OPT_BOAT_SPEED_26",get:function get(){return[2.7,3.4,4.1,4.7,5.3,5.7,5.8,6.3,7.6,7.4,7.2,7.4,7.6,7.8,8,8.1,8.3,8.5,8.7,8.9,9.1,9.3,9.5,9.8,10,10.3,10.7]}},{key:"OPT_BOAT_SPEED_27",get:function get(){return[2.6,3.3,4,4.5,5.1,5.5,5.6,6.1,6.2,6.6,7,7.2,7.4,7.6,7.8,7.9,8.1,8.2,8.4,8.6,8.8,9,9.2,9.5,9.7,10,10.3]}},{key:"OPT_BOAT_SPEED_28",get:function get(){return[2.5,3.2,3.9,4.4,4.9,5.3,5.4,5.8,6,6.3,6.7,6.9,7.2,7.4,7.5,7.7,7.8,8,8.2,8.4,8.6,8.8,9,9.2,9.4,9.6,10]}},{key:"OPT_BOAT_SPEED_29",get:function get(){return[2.4,3.1,3.7,4.2,4.7,5.1,5.3,5.6,5.8,6.1,6.4,6.7,7,7.2,7.3,7.4,7.6,7.7,7.9,8.1,8.3,8.5,8.7,8.9,9.1,9.3,9.6]}},{key:"OPT_BOAT_SPEED_30",get:function get(){return[2.3,2.9,3.6,4.1,4.5,4.9,5.1,5.4,5.6,5.9,6.1,6.5,6.8,7,7.1,7.2,7.3,7.5,7.7,7.9,8.1,8.3,8.4,8.6,8.8,9,9.3]}},{key:"OPT_BOAT_SPEED_31",get:function get(){return[2.2,2.8,3.5,3.9,4.4,4.7,4.9,5.2,5.4,5.6,5.9,6.2,6.6,6.7,6.9,7,7,7.2,7.4,7.6,7.8,8,8.1,8.3,8.5,8.7,8.9]}},{key:"OPT_BOAT_SPEED_32",get:function get(){return[2.1,2.7,3.3,3.8,4.2,4.5,4.7,5,5.2,5.4,5.6,6,6.4,6.5,6.6,6.7,6.8,7,7.2,7.4,7.6,7.8,7.9,8,8.2,8.4,8.6]}},{key:"OPT_BOAT_SPEED_33",get:function get(){return[2,2.6,3.2,3.6,4,4.3,4.5,4.8,5,5.2,5.3,5.8,6.2,6.3,6.4,6.5,6.5,6.7,6.9,7.1,7.3,7.5,7.6,7.7,7.9,8.1,8.2]}}]);return SimulatorCore}();